# Filename: k8s-4peers-config.yaml, part of advlabtools; https://github.com/ynakaoku/advlabtools
# Author: Yoshihiko Nakaoku; ynakaoku@vmware.com

# Definition of test flows between Server/Clinets. Server/Clients instances can be 
# kubernetes containers or VMs for your tests purpose respectively. 
#
# flows: Definition of test flows. Conjunction of server and client definition.
#        Actual definition of single flow will be like below:
#----------------------------------------------------------------------------------
# flows:
#  - server:
#      name: iperf3-dep1
#      type: kubernetes
#    client:
#      name: iperf3-dep5
#      type: kubernetes
#    target: iperf3-dep1
#----------------------------------------------------------------------------------
# server : A part of flows. Server will receive test traffic generated by clients. 
#          Each server entry includes name and type. 
#           - name: resolvable name or IP address of the server management port. 
#           - type: type of the server, in case of 'kubernetes', test program will 
#                   try to start server process via 'kubectl exec' command rather than ssh.
# client : A part of flows. Client will generate test traffic and send to server.
#          Each client entry includes name and type. 
#           - name: resolvable name or IP address of the client management port. 
#           - type: type of the client, in case of 'kubernetes', test program will 
#                   try to start client process via 'kubectl exec' command rather than ssh.
# targets : A part of flows. Resolvable name or IP address. Client will try to send 
#           test traffic to this endpoint. 
# mode : Test mode. Select "iperf", "iperf3" or "httpd".
# proto : target protocol of iperf test. Select "tcp" or "udp".
#
# Below is example of single server-client pair for testing:
#
#                   +-----------+       target  +-----------+
# client name/ip -> |  client   |-------------->|  server   | <- server name/ip
#                   +-----------+               +-----------+
#
flows:
  - server:
      name: iperf3-dep1
      type: kubernetes
    client:
      name: iperf3-dep5
      type: kubernetes
    target: iperf3-dep1
  
  - server:
      name: iperf3-dep2
      type: kubernetes
    client:
      name: iperf3-dep6
      type: kubernetes
    target: iperf3-dep2
  
  - server:
      name: iperf3-dep3
      type: kubernetes
    client:
      name: iperf3-dep7
      type: kubernetes
    target: iperf3-dep3
  
  - server:
      name: iperf3-dep4
      type: kubernetes
    client:
      name: iperf3-dep8
      type: kubernetes
    target: iperf3-dep4

mode: iperf3
proto: tcp
